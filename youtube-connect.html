<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>YouTube Fan Account Connect</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { 
      font-family: 'Manrope', sans-serif; 
      max-width: 400px; 
      margin: 50px auto; 
      text-align: center; 
      background-color: #121212; 
      color: #ffffff;
      padding: 20px;
    }
    input, button { 
      width: 100%; 
      margin: 10px 0; 
      padding: 12px; 
      font-size: 16px; 
      border-radius: 8px;
      border: none;
      font-family: 'Manrope', sans-serif;
      box-sizing: border-box;
    }
    input {
      background-color: #1e1e1e;
      color: #ffffff;
    }
    input::placeholder {
      color: #aaaaaa;
    }
    button { 
      background: #cc0000; 
      color: white; 
      cursor: pointer; 
      font-weight: 600;
      transition: background 0.2s;
    }
    button:hover {
      background: #e60000;
    }
    button:disabled {
      background: #666666;
      cursor: not-allowed;
    }
    #status {
      margin-top: 20px;
      font-size: 14px;
      color: #bbbbbb;
    }
    .success {
      color: #4CAF50;
    }
    .error {
      color: #ff4444;
    }
  </style>
</head>
<body>
  <h2>üîó Connect Your YouTube Fan Account</h2>
  <p>Enter your Artist Name and click Connect</p>
  <input id="artist" placeholder="Artist Name" required>
  <button id="connectBtn" onclick="connectYouTube()">Connect with YouTube</button>
  <p id="status"></p>
  <script>
  // CONFIG: Replace with your Apps Script Web App URL
  const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyEbIYui7jiculaFNXoZmTIFdaoth-dFdUBGuI3JFQVIY0uUy-GKF9ihtYvsUBH842Y/exec"; // Deine neue GAS-URL
  
  function connectYouTube() {
    const artist = document.getElementById("artist").value.trim();
    const status = document.getElementById("status");
    const btn = document.getElementById("connectBtn");
    
    if (!artist) {
      status.className = "error";
      status.textContent = "‚ùå Please enter your Artist Name.";
      return;
    }
    
    status.className = "";
    status.textContent = "Redirecting to authentication...";
    btn.disabled = true;
    
    fetch(APPS_SCRIPT_URL + "?action=start&artist=" + encodeURIComponent(artist))
      .then(response => response.json())
      .then(data => {
        if (data.redirect) {
          window.location.href = data.redirect;
        } else {
          status.className = "error";
          status.textContent = "‚ùå Failed to get redirect URL.";
          btn.disabled = false;
        }
      })
      .catch(error => {
        status.className = "error";
        status.textContent = "‚ùå Connection failed: " + error;
        btn.disabled = false;
      });
  }
  
  // Check if we returned from OAuth with success/error
  const urlParams = new URLSearchParams(window.location.search);
  const result = urlParams.get('result');
  const status = document.getElementById("status");
  
  if (result === 'success') {
    status.className = "success";
    status.textContent = "‚úÖ Successfully connected! Your channel data has been saved.";
  } else if (result === 'error') {
    status.className = "error";
    status.textContent = "‚ùå Connection failed. Please try again.";
  }
</script>
</body>
</html>
